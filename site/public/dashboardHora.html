<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>775N - 12:00</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="shortcut icon" href="images/icon.png" type="image/x-icon">
</head>
<body>
    <!--Começando a barra lateral das KPIs-->
    <div id="sidebar" class="sidebarHora">
        <div id="KPIDias">
            <span>Dia Mais Cheio:</span>
            <p>Segunda-Feira</p>
            <span>Dia Mais Vazio:</span>
            <p>Sábado</p>
        </div>
        <div id="KPIMovimentaçãoPontos">
            <span>Ponto de Maior Pico</span>
            <p>7</p>
            <p>Av. Rebouças, 2549</p>
            <span>Ponto de Menor Pico</span>
            <p>3</p>
            <p>Av. Eng. Heitor, 1421</p>
        </div>
        <div id="KPIVeiculos" class="KPIAlerta">
            <span>Percentual de viagens mal aproveitadas</span>
            <p class="alerta">16% das viagens</p>
        </div>
    </div>
    <!--Terminada a barra lateral das KPIs-->
    <!--Início do conteúdo principal da dashboard-->
    <div id="conteudoDashboard">
        <!--Início do corpo da dashboard-->
        <div id="corpoDashboard">
            <!--Início do cabeçalho da dashboard, contendo o título da rota, suas infos. e classificação-->
            <div id="cabecalhoDashboard">
                <div id="tituloRota" class="tituloBom">
                    <h1>775N</h1>
                    <div id="infosRota">
                        <p><i>Rota Normal</i> (10)</p>
                        <p>Term. Vila Madalena</p>
                        <p>Rio Pequeno</p>
                    </div>
                </div>
                <div id="dicaDias">
                    Clique em um dos dias na legenda para ocultá-lo, facilitando a visualização dos demais. Para exibi-lo
                    novamente, basta clicá-lo que ele volta a aparecer no gráfico.  
                </div>
            </div>
            <!--Fim do cabeçalho da dashboard-->
            <!--Início da área do gráfico da dashboard-->
            <div id="graficoDashboard"><!--Esta div contém, além do gráfico, seu título e uma descrição de como visualizar-->
                <h2>Média do horário das 12:00</h2><!--cada horário por si só.-->
                <canvas id="graficoRota"></canvas>
            </div>
            <!--Fim da área do gráfico da dashboard-->
        </div>
        <!--Fim do corpo da dashboard-->
        <!--Início da barra lateral da classificação e dos veículos nessa rota-->
            <div id="sidebarOutrosDados">
                <div id="classificacao">
                    <p class="classificIdeal" id="classificIdeal">Boa</p>
                    <canvas id="graficoClassific"></canvas>
                    <p>Classificação da hora</p>
                    <details>
                        Nosso sistema tem três tipos de classificação para uma rota: ruim, boa e ideal; baseados no índice 
                        de aproveitamento dos recursos dispostos. Rotas vazias ou extremamente superlotadas geram uma 
                        classificação baixa.
                    </details>
                </div>
                <div id="veiculosDashboard">
                    <h3>Veículos</h3>
                    <span>utilizados nesse horário</span>
                    <div id="tabelaVeiculosDashboard">
                        <div id="tabelaVeiculosCabecalho" class="tabelaVeiculosLinha">
                           <p>Placa</p>
                            <p>Lotação</p>
                            <p>Modelo</p>
                        </div>
                        <div class="tabelaVeiculosLinha">
                            <p>EEL-6867</p>
                            <p>70</p>
                            <p>Básico</p>
                        </div>
                        <div class="tabelaVeiculosLinha">
                            <p>EXR-4682</p>
                            <p>80</p>
                            <p>Padron</p>
                        </div>
                    </div>
                </div>
                <div id="containerGraficoVeiculos">
                    <canvas id="graficoVeiculos"></canvas>
                </div>
                <a href="dashboardGeral.html">< VOLTAR</a>
            </div>
            <!--Fim da barra lateral dos veículos nessa rota-->
    </div>
    <!--Fim do conteúdo principal da dashboard-->
</body>
</html>
<script>
    if(sessionStorage.HORARIO_DA_LINHA == undefined){
        window.location.href = "menuDashboard.html";
    }
    else{
        alert(sessionStorage.HORARIO_DA_LINHA);
    }
    //Gráfico geral da rota
    const pontos = [
        "Av José Felipe, 580",
        "R. Pe. Alarico, 31",
        "Av. Eng. Heitor, 1421",
        "Av Corifeu, 1975",
        "Av. Dr. Vital Brasil, 569",
        "Av. Eusébio Matoso, 133",
        "Av Rebouças, 2903",
        "Av Rebouças, 2549",
        "Av Rebouças, 2012",
        "Av Rebouças, 1723",
        "Av Rebouças, 1123",
        "Av Rebouças, 782",
        "Av Rebouças, 201",
        "Av. Paulista, 2319",
        "Av. Paulista, 1833",
        "Av. Brig. Luís Antônio, 1289",
        "Av. da Liberdade, 333"
    ]
    const lotacaoOnibus = 70;
    const dadosHora = {
        labels:pontos,
        datasets: [{
                label: "06/01, seg.",
                data: [10,15,22,28,35,42,46,49,54,59,64,58,50,39,30,24,13]
            },
            {
                label: "07/01, ter.",
                data: [8,13,20,25,32,36,40,43,50,53,60,53,49,40,36,29,18]
            },
            {
                label: "08/01, qua.",
                data: [10,15,22,28,35,42,46,49,54,59,64,58,50,39,30,24,13]
            },
            {
                label: "09/01, qui.",
                data: [8,15,20,27,32,39,45,49,54,58,64,57,50,44,39,27,16]
            },
            {
                label: "10/01, sex.",
                data: [12,19,27,30,39,45,53,60,64,70,73,71,76,69,60,53,47]
            },
            {
                label: "11/01, sab.",
                data: [2,0,4,8,12,16,17,17,20,21,20,23,23,18,14,8,4]
            },
        ]
    }
    const configGraficoGeral = {
        type: "line",
        data: dadosHora,
        options: {
            maintainAspectRatio: false,
            scales: {
                y: {
                    max: (lotacaoOnibus +25)
            }
            }
        }
    }
    const graficoGeral = new Chart(
        document.getElementById("graficoRota"),
        configGraficoGeral
    );

    // Gráfico dos ônibus na rota
    // Todos os modelos:
    // const modelos = [
    //     "Miniônibus",
    //     "Midiônibus",
    //     "Básico",
    //     "Padron",
    //     "Articulado",
    //     "Biarticulado"
    // ]
     const modelos = [
         "Básico",
         "Padron",
    ]
    const dadosVeiculos = {
        labels:modelos,
        datasets: [{
                data: [2,1],
                backgroundColor: ['#69503C','#BD916E']
            }
        ]
    }
    const configGraficoVeiculos = {
        type: "pie",
        data: dadosVeiculos,
        options: {
            plugins: {
                legend: {
                    position: "bottom"
                }
            }
        }
    }
    const graficoVeiculos = new Chart(
        document.getElementById("graficoVeiculos"),
        configGraficoVeiculos
    );

    //Gráfico classificação
    const corClassific = '#00BF63';
    //document.getElementById("tituloRota").style = `backgroundColor: ${corClassific}`;
    //NAO CONSEGUI FAZER - GUS 27/04
    const classificacao = ["Otimização Atual","Melhora possível"]
    const dadosClassfic = {
        labels: classificacao,
        datasets: [{
                backgroundColor: [corClassific,"white"],
                borderColor: [corClassific],
                borderWidth: "0.5",
                data: [77,33],
                circumference: 180,
                rotation: 270
            }
        ]
    }
    const configGraficoClassific = {
        type: "doughnut",
        data: dadosClassfic,
        options: {
            aspectRatio: '1/4',
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    }
    const graficoClassific = new Chart(
        document.getElementById("graficoClassific"),
        configGraficoClassific
    );
</script>